<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="blog">


	 <!-- 메인게시판 카테고리별 제목 조회 -->
	<select id="findPost" parameterType="int" resultType="postVo">
	<![CDATA[
			select no, title, date_format(regDate, '%Y-%m-%d %H:%i:%s') regDate from post where categoryNo=#{categoryNo} order by regDate desc
	]]>
	</select>
	
	<!-- 메인게시판 제목별 제목, 내용 조회 -->
	<select id="find" parameterType="int" resultType="postVo">
	<![CDATA[
			select no, title, content from post where no=#{no}
	]]>
	</select>

	 <!-- 블로그 정보 조회 -->
	<select id="findBlog" parameterType="String" resultType="blogvo">
	<![CDATA[
			select title, logo from blog where userId=#{userId};
	]]>
	</select>
	
	 <!-- 블로그 정보 수정 -->
	<update id="updateBlog" parameterType="map">
	<![CDATA[
			update blog set title=#{title}, logo=#{logo} where userId=#{userId};
	]]>
	</update>
	 
	<!-- 카테고리 전체 조회 -->
	<select id="findCategory" parameterType="String" resultType="categoryvo">
	<![CDATA[
			select no, name, descrpition, blogId from category where blogId=#{blogId} order by no desc;
	]]>
	</select>
	
	<!-- 특정 카테고리 개수 구하기 -->
	<select id="findCategoryCount" parameterType="int" resultType="int">
	<![CDATA[
			select count(*) from post where categoryNo=#{categoryNo}
	]]>
	</select>
	
	<!-- 카테고리 목록 추가하기 -->
	<select id="insertCategory" parameterType="categoryvo">
	<![CDATA[
			insert into category values(null, #{name}, #{descrpition}, #{blogId})
	]]>
	</select>
	
	<!-- 카테고리 삭제하기 -->
	<delete id="deleteCategory" parameterType="map">
	<![CDATA[
			delete from category where no=#{no} and blogId=#{blogId}
	]]>
	</delete>
	
	<!-- 특정 카테고리 번호 가져오기 -->
	<select id="findCategoryNo" parameterType="map" resultType="int">
	<![CDATA[
			select no from category where blogId=#{blogId} and name=#{name}
	]]>
	</select>
	
	<!-- 카테고리 글 추가하기 -->
	<insert id="insert" parameterType="postvo">
		<![CDATA[
		insert into post values(null, #{title}, #{content}, now(), #{categoryNo})
		]]>
	</insert>
	
</mapper>

